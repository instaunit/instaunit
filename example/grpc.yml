protos:
  - grpc/service_descriptors.pb

tests:
  -
    id: user1

    grpc:
      service: grpcservice.UserService
      method: CreateUser

    request:
      url: localhost:8800
      entity: |
        {
          "user": {
            "name": "John Doe",
            "email": "john@example.com",
            "age": 30,
            "is_active": true,
            "tags": [
              "developer",
              "golang"
            ],
            "metadata": {
              "department": "Engineering",
              "level": "Senior"
            },
            "address": {
              "street": "123 Main St",
              "city": "San Francisco",
              "state": "CA",
              "zip_code": "94102",
              "country": "USA"
            },
            "type": "USER_TYPE_REGULAR",
            "phone": "+1-555-0123"
          }
        }

    response:
      entity: |
        {
          "user": {
            "name": "John Doe",
            "email": "john@example.com",
            "age": 30,
            "is_active": true,
            "tags": [
              "developer",
              "golang"
            ],
            "metadata": {
              "department": "Engineering",
              "level": "Senior"
            },
            "address": {
              "street": "123 Main St",
              "city": "San Francisco",
              "state": "CA",
              "zip_code": "94102",
              "country": "USA"
            },
            "type": "USER_TYPE_REGULAR",
            "phone": "+1-555-0123"
          }
        }

  -
    grpc:
      service: grpcservice.UserService
      method: GetUser

    request:
      url: localhost:8800
      entity: |
        {
          "user_id": ${user1.response.value.id}
        }

    response:
      entity: |
        {
          "user": {
            "name": "John Doe",
            "email": "john@example.com",
            "age": 30,
            "is_active": true,
            "tags": [
              "developer",
              "golang"
            ],
            "metadata": {
              "department": "Engineering",
              "level": "Senior"
            },
            "address": {
              "street": "123 Main St",
              "city": "San Francisco",
              "state": "CA",
              "zip_code": "94102",
              "country": "USA"
            },
            "type": "USER_TYPE_REGULAR",
            "phone": "+1-555-0123"
          }
        }
